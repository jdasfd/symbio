# 植物分类

## 基本情况说明：

选取相关的植物，尽量覆盖整个植物系统发育的情况：

- Selaginella为卷柏属，Lycopodium为石松属，之前都归在Pteridophyta（蕨类植物门）之下。后来将蕨类植物中的卷柏分出，作为石松类植物。目前石松类植物只有两个基因组，均为卷柏属下的植物，其中一个并不含有注释文件。目前Lycopodiopsida（石松纲）下有3个部分：Isoetales/quillworts（水韭目），Lycopodiales（石松目），Selaginellales/spike mosses（卷柏目）。
- 蕨类（Polypodiidae/Fern）：目前主要包括3个已测序的目
  - 桫椤目（Cyatheales）
  - 水龙骨目（Polypodiales），两个测序的物种都在凤尾蕨科（Pteridaceae）
  - 槐叶萍目（Salviniales），两个测序的物种都在槐叶萍科（Salviniaceae）
    - Adiantum capillus-veneris（铁线蕨）目前刚刚被测序完成并组装，且提供注释文件，目前尚未被数据库收录。
- 裸子植物（Gymnosperm）：目前主要包括4个主要的lineages
  - 苏铁（Cycads）
  - 银杏（Ginkgo）
  - 松柏类（Conifers）
  - 买麻藤（Gnetophyte）
- 黄藤（Daemonorops jenkinsiana）在NCBI中更改为Calamus jenkinsiana，两个名字均一样，目前采信NCBI taxonomy。

## 一些中文名称

- 藻类：
  - Chlamydomonas reinhardtii - 莱茵绿藻
  - Volvox carteri - 某种团藻
  - Chromochloris zofingiensis - 佐夫色绿藻
  - Botryococcus braunii - 布朗氏葡萄藻
  - Chara braunii - 布氏轮藻
  - Mesotaenium endlicherianum - 双星藻
- Basal land plants 包括 liverworts/mosses/hornworts：
  - Sphagnum magellanicum - 中位泥炭藓
  - Sphagum recurvum (old: Sphagnum fallax) - 喙叶泥炭藓
  - Physcomitrium patens - 立碗藓类
  - Marchantia polymorpha - 地钱
  - Ceratodon purpureus - 角齿藓
- Lycopodiopsida - 石松类：
  - Selaginella moellendorffii - 江南卷柏
- Fern - 蕨类：
  - Alsophila spinulosa - 桫椤
  - Ceratopteris richardii - 美洲水蕨
  - Adiantum capillus - 铁线蕨
  - Azolla filiculoides - 细叶满江红
  - Salvinia cucullata - 勺叶槐叶萍
- Gymnosperm - 裸子植物
  - Cycas panzhihuaensis - 攀枝花苏铁 
  - Ginkgo biloba - 银杏
  - Conifers II：
    - Taxus wallichiana - 红豆杉
    - Taxus wallichiana var. chinensis (old: Taxus chinensis) - 红豆杉
    - Sequoiadendron giganteum - 巨杉（giant sequoia）
  - Conifers I：
    - Pinus taeda - 火炬松（loblolly pine）
    - Pinus tabuliformis - 油松（southern Chinese pine）
    - Picea abies - 欧洲云杉（Norway spruce）
    - Picea glauca - 白云杉（White spruce）
    - Abies alba - 银冷杉（silver fir）
  - Gnetidae（买麻藤纲）：
    - Welwitschia mirabilis - 百岁兰
    - Gnetum montanum - 买麻藤
- Angiosperm - 被子植物
  - 被子植物基部
    - Amborella trichopoda - 无油樟
    - Nymphaea colorata - 蓝星睡莲
    - Nymphaea thermarum - 侏儒卢旺达睡莲/小睡莲
  - 两个单独分支
    - Ceratophyllum demersum - 金鱼藻
    - Chloranthus sessilifolius - 金粟兰
  - 木兰类
    - Chimonanthus salicifolius - 柳叶蜡梅
    - Cinnamomum micranthum (old: Cinnamomum kanehirae) - 沉水樟
    - Persea americana - 鳄梨
    - Liriodendron chinense - 鹅掌楸
  - 单子叶
    - Alismatales - 泽泻目
      - Araceae - 天南星科
        - Lemna minor - 浮萍
        - Spirodela polyrhiza - 紫萍
      - Zosteraceae - 大叶藻科
        - Zostera marina - 大叶藻
        - Zostera muelleri - 南半球海草（暂定）
    - Asparagales - 天门冬目
      - Amaryllidaceae - 石蒜科
        - Allium sativum - 蒜
      - Asparagaceae - 天门冬科
        - Asparagus officinalis - 石刁柏（俗名：芦笋）
        - Asparagus setaceus - 文竹
      - Orchidaceae - 兰科
        - Apostasia shenzhenica - 深圳拟兰
        - Gastrodia elata - 天麻
        - Dendrobium catenatum - 黄石斛
        - Phalaenopsis aphrodite - 蝴蝶兰
        - Phalaenopsis equestris - 小兰屿蝴蝶兰
        - Vanilla planifolia - 香荚兰
    - Arecales - 棕榈目
      - Arecaceae - 棕榈科
        - Cocos nucifera - 椰子
        - Elaeis guineensis - 油棕
        - Calamus simplicifolius - 单叶省藤
        - Calamus jenkinsiana (old: Daemonorops jenkinsiana) - 黄藤
        - Phoenix dactylifera - 海枣
    - Poales - 禾本目
      - Bromeliaceae - 凤梨科
        - Ananas comosus var. bracteatus (old: Ananas bracteatus) - 红凤梨
        - Ananas comosus - 凤梨
      - Cyperaceae - 莎草科
        - Carex littledalei (old: Kobresia littledalei) - 康藏嵩草
      - Poaceae - 禾本科
        - Phyllostachys edulis - 毛竹
        - Bonia amplexicaulis - 芸香竹
        - Guadua angustifolia - 瓜多竹
        - Olyra latifolia - 莪莉竹
        - Leersia perrieri 马达加斯加稻属，目前稻的外类群
        - Oryza barthii - 巴蒂稻
        - Oryza brachyantha - 短花稻
        - Oryza longistaminata - 长药稻
        - Oryza rufipogon - 野生稻
        - Puccinellia tenuiflora - 星星草
        - Lolium perenne - 黑麦草
        - Brachypodium distachyon - 二穗短柄草
        - Hordeum vulgare - 大麦
        - Aegilops tauschii - 节节麦
        - Triticum aestivum - 小麦
        - Triticum turgidum - 圆锥小麦
        - Eleusine coracana - 穇
        - Oropetium thomaeum 一种耐旱草类，尚无英文名，PacBio三代
        - Eragrostis curvula - 弯叶画眉草
        - Eragrostis tef - 苔麸
        - Zoysia japonica - 结缕草
        - Miscanthus sinensis - 芒
        - Saccharum spontaneum - 甜根子草
        - Sorghum bicolor - 高粱
        - Zea mays - 玉蜀黍（玉米）
        - Setaria italica - 粱
        - Setaria viridis - 狗尾草
        - Panicum virgatum - 柳枝稷
    - Zingiberales - 姜目
      - Musaceae - 芭蕉科
        - Ensete ventricosum - 粗柄象腿蕉
        - Musa schizocarpa 未知
  - 真双子叶基部
    - Ranunculales - 毛茛目
      - Circaeasteraceae - 星叶草科
        - Kingdonia uniflora - 独叶草
      - Papaveraceae - 罂粟科
        - Eschscholzia californica - 花菱草
        - Macleaya cordata - 博落回
        - Papaver somniferum - 罂粟
      - Ranunculaceae - 毛茛科
        - Aquilegia coerulea 耧斗菜的一种
    - Proteales - 山龙眼目
      - Nelumbonaceae - 莲科
        - Nelumbo nucifera - 莲
      - Proteaceae - 山龙眼科
        - Macadamia integrifolia - 澳洲坚果/夏威夷果
    - Trochodendrales - 昆栏树目
      - Trochodendraceae - 昆栏树科
        - Tetracentron sinense - 水青树
  - 核心真双子叶
    - Saxifragales - 虎耳草目
      - Crassulaceae - 景天科
        - Kalanchoe fedtschenkoi - 玉吊钟
    - Vitales - 葡萄目
      - Vitaceae - 葡萄科
        - Vitis vinifera - 葡萄
    - 蔷薇分支豆类
      - Celastrales - 卫矛目
        - Celastraceae - 卫矛科
          - Tripterygium wilfordii - 雷公藤
      - Oxalidales - 酢浆草目
        - Cephalotaceae - 土瓶草科
          - Cephalotus follicularis - 土瓶草
        - Oxalidaceae - 酢浆草科
          - Averrhoa carambola - 阳桃（杨桃）
      - Malpighiales - 金虎尾目
        - Euphorbiaceae - 大戟科
          - Ricinus communis - 蓖麻
          - Jatropha curcas - 麻风树
          - Manihot esculenta - 木薯
          - Hevea brasiliensis - 橡胶树
        - Linaceae - 亚麻科
          - Linum usitatissimum - 亚麻
        - Passifloraceae - 西番莲科
          - Passiflora edulis - 鸡蛋果（百香果）
        - Rhizophoraceae - 红树科
          - Kandelia obovata - 秋茄树
        - Salicaceae - 杨柳科
          - Populus alba - 银白杨
          - Populus pruinosa - 灰胡杨
          - Populus trichocarpa - 毛果杨
          - Salix brachista - 小垫柳
      - Fabales - 豆目
        - Fabaceae - 豆科
          - Chamaecrista fasciculata
          - Faidherbia albida - 环荚合欢
          - Mimosa pudica - 含羞草
          - Cercis canadensis - 加拿大紫荆
          - Arachis duranensis - 蔓花生
          - Arachis hypogaea - 落花生
          - Cajanus cajan - 木豆
          - Cicer arietinum - 鹰嘴豆
          - Glycine soja - 野大豆
          - Lablab purpureus - 扁豆
          - Lotus japonicus (Lotus corniculatus subsp. japonicus) - 光叶百脉根
          - Lupinus albus - 白羽扇豆
          - Lupinus angustifolius - 狭叶羽扇豆
          - Phaseolus lunatus - 棉豆
          - Phaseolus vulgaris - 菜豆
          - Pisum sativum - 豌豆
          - Spatholobus suberectus - 密花豆
          - Trifolium pratense - 红车轴草
          - Trifolium subterraneum - 地车轴草
          - Vigna angularis - 赤豆
          - Vigna radiata - 绿豆
          - Vigna unguiculata - 豇豆
      - Rosales - 蔷薇目
        - Cannabaceae - 大麻科
          - Cannabis sativa - 大麻
        - Moraceae - 桑科
          - Artocarpus altilis - 面包树
          - Artocarpus heterophyllus - 波罗蜜
        - Rosaceae - 蔷薇科
          - Prunus avium - 欧洲甜樱桃
          - Prunus mume - 梅
          - Prunus persica - 桃
          - Pyrus betulifolia - 杜梨
          - Pyrus communis - 西洋梨
          - Eriobotrya japonica - 枇杷
          - Dryas drummondii - 亮黄仙女木
          - Fragaria nilgerrensis - 黄毛草莓
          - Fragaria vesca - 野草莓
          - Rosa chinensis - 月季花
      - Cucurbitales - 葫芦目
        - Begoniaceae - 秋海棠科
          - Begonia fuchsioides - 倒挂金钟秋海棠
        - Cucurbitaceae - 葫芦科
          - Cucumis melo - 甜瓜
          - Cucumis sativus - 黄瓜
          - Lagenaria siceraria - 葫芦
          - Cucurbita argyrosperma - 墨西哥南瓜
          - Cucurbita maxima - 笋瓜
          - Cucurbita moschata - 南瓜
          - Cucurbita pepo - 西葫芦
        - Datiscaceae - 野麻科
          - Datisca glomerata - 头序野麻
      - Fagales - 壳斗目
        - Betulaceae - 桦木科
          - Alnus glutinosa - 欧洲桤木
        - Casuarinaceae - 木麻黄科
          - Casuarina glauca - 粗枝木麻黄
          - Castanea mollissima - 栗
        - Fagaceae - 壳斗科
          - Quercus suber - 欧洲栓皮栎
        - Juglandaceae - 胡桃科
          - Juglans nigra - 黑胡桃
          - Juglans regia - 胡桃
    - 蔷薇分支锦葵类
      - Myrtales - 桃金娘目
        - Lythraceae - 千屈菜科
          - Punica granatum - 石榴
        - Myrtaceae - 桃金娘科 
          - Eucalyptus grandis - 大桉
      - Sapindales - 无患子目
        - Anacardiaceae - 漆树科
          - Mangifera indica - 杧果
          - Pistacia vera - 阿月浑子（开心果）
          - Sclerocarya birrea - 象李
        - Rutaceae - 芸香科
          - Citrus clementina - 克莱门氏小柑橘
          - Citrus maxima (old: Citrus grandis) - 柚
          - Citrus cavaleriei (old: Citrus ichangensis) - 宜昌橙
          - Citrus medica - 香橼
          - Citrus sinensis - 甜橙
        - Sapindaceae - 无患子科
          - Dimocarpus longan - 龙眼
          - Xanthoceras sorbifolium - 文冠果
      - Malvales - 锦葵目
        - Malvaceae - 锦葵科
          - Bombax ceiba - 木棉
          - Theobroma cacao - 可可
          - Corchorus capsularis - 黄麻
          - Corchorus olitorius - 长蒴黄麻
          - Gossypium darwinii - 达尔文棉
          - Gossypium herbaceum - 草棉
          - Gossypium hirsutum - 陆地棉
          - Gossypium mustelinum - 黄褐棉
          - Gossypium raimondii - 美洲棉
          - Hibiscus syriacus - 木槿
        - Thymelaeaceae - 瑞香科
          - Aquilaria sinensis - 土沉香
      - Brassicales - 十字花目
        - Brassicaceae - 十字花科
          - Aethionema arabicum - 小亚细亚岩芥
          - Brassica rapa - 蔓菁
        - Moringaceae - 辣木科
          - Moringa oleifera - 辣木
        - Caricaceae - 番木瓜科
          - Carica papaya - 番木瓜
    - Caryophyllales - 石竹目
      - Amaranthaceae - 苋科
        - Amaranthus hypochondriacus - 千穗谷
      - Chenopodiaceae - 藜科
        - Beta vulgaris - 甜菜
      - Polygonaceae - 蓼科
        - Fagopyrum esculentum - 荞麦
    - 菊类分支
      - Cornales - 山茱萸目
        - Nyssaceae - 蓝果树科
          - Davidia involucrata - 珙桐
      - Ericales - 杜鹃花目
        - Actinidiaceae - 猕猴桃科
          - Actinidia chinensis - 中华猕猴桃
          - Actinidia eriantha - 毛花猕猴桃
        - Ebenaceae - 柿树科
          - Diospyros lotus - 君迁子
        - Ericaceae - 杜鹃花科
          - Rhododendron delavayi - 马缨杜鹃
      - 菊分支唇形类
        - Garryales - 丝樱花目
          - Eucommiaceae - 杜仲科
            - Eucommia ulmoides - 杜仲
        - Solanales - 茄目
          - Convolvulaceae - 旋花科（包含菟丝子科）
            - Cuscuta australis - 南方菟丝子
            - Cuscuta campestris - 原野菟丝子
            - Ipomoea triloba - 三裂叶薯（红花野牵牛）
          - Solanaceae - 茄科
            - Nicotiana attenuata - 渐狭叶烟草
            - Capsicum annuum - 辣椒
            - Solanum chilense - 智利番茄
            - Solanum lycopersicum - 番茄（小番茄）
            - Solanum pennellii - 彭氏番茄
            - Solanum tuberosum - 马铃薯
        - Gentianales - 龙胆目
          - Apocynaceae - 夹竹桃科
            - Calotropis gigantea - 牛角瓜
          - Rubiaceae - 茜草科
            - Coffea canephora - 中粒咖啡
        - Lamiales - 唇形目
          - Bignoniaceae - 紫葳科
            - Handroanthus impetiginosus - 粉红钟花
          - Gesneriaceae - 苦苣苔科
            - Boea hygrometrica - 旋蒴苣苔
          - Lamiaceae - 唇形科
            - Salvia bowleyana - 南丹参
          - Lentibulariaceae - 狸藻科
            - Utricularia gibba - 少花狸藻（丝叶狸藻）
          - Oleaceae - 木犀科
            - Olea europaea - 木樨榄（油橄榄）
          - Phrymaceae - 透骨草科
            - Mimulus guttatus - 多斑沟酸浆
      - 菊分支桔梗类
        - Asterales - 菊目
          - Astereae - 菊科
            - Chrysanthemum indicum - 野菊
            - Chrysanthemum lavandulifolium (old: Chrysanthemum seticuspe) - 甘菊
            - Erigeron breviscapus - 短莛飞蓬
            - Mikania micrantha - 微甘菊
            - Helianthus annuus - 向日葵
            - Cynara cardunculus - 刺苞菜蓟
            - Lactuca sativa - 莴苣
        - Apiales - 伞形目
          - Apiaceae - 伞形科
            - Apium graveolens - 旱芹（芹菜）
            - Coriandrum sativum - 芫荽（香菜）
        - Dipsacales - 川续断目
          - Caprifoliaceae - 忍冬科
            - Lonicera japonica - 忍冬

## Preparation

Visit [Anaconda](https://www.anaconda.com/) to download install script.

Visit [BUSCO userguide](https://busco.ezlab.org/busco_userguide.html#conda-package) for database.

```bash
# install anaconda
bash Anaconda3-2022.05-Linux-x86_64.sh
# enter to allow and complete installation
# start linux again, directly activating base

# avoid directly activating base when start linux
conda config --set auto_activate_base false
# conda install busco
conda create -n genome -c conda-forge -c bioconda busco=5.4.2
# activate env
conda activate genome
```

## Process genome

### Genomes selection and CDS renaming

- Extract CDS and rename with species names

```bash
mkdir ~/data/symbio/info
cd ~/data/symbio/info

# manually pick some genomes into taxo_genom.xlsx

perl ~/Scripts/fig_table/xlsx2csv.pl -f taxo_genom.xlsx |
    tsv-select -d, -f 1 |
    sed 1d |
    perl -nl -e '$_ = lc $_;print $_' \
    > genome.lst

wc -l genome.lst
#149 genome.lst

#cat genome.lst |
#    perl -nl -e 'print qq($_\t);' \
#    > genome_trans.tsv

mkdir ~/data/symbio/GENOMES_raw
cd ~/data/symbio/GENOMES_raw
# manually download genomes into this directory

for genome in $(cat ../info/genome.lst)
do
    if ! [[ -d ./${genome} ]]; then
        echo ${genome}
    fi
done
# check whether there were some missing genomes
# manually check and download them

cat ../info/genome.unexist.lst | sort
# manually rename them to the uniform format
rm ../info/genome.unexist.lst

# prepare all the cds files and rename them
bash ../scripts/cds_prep.sh
# this process will take a while
# genomes without problem will be re-named and moved into GENOMES_done dir
# genomes with problem will be moved to the manually dir
# check them manually one by one

# part of the situation (maybe combined into one script later)
# this is the pattern
# first situation: Using OriID
cat genome.longest.gff |
    tsv-filter --str-eq 3:mRNA |
    tsv-select -f 9 |
    perl -nle 'print "$2\tspecies_name_$1" if /Name=(.+?);Source_ID=(.+);$/;' \
    > name.lst

cat genome.cds |
    perl -nle '
    print if /^[ATCGN]/i;
    print ">$1" if /^>.+OriID=(.+?)\s/;
    ' \
    > species_name.cds

faops replace -s species_name.cds name.lst species_name.cds.fa

mkdir ../../GENOMES/species_name
mv species_name.cds.fa name.lst ../../GENOMES/species_name
rm species_name.cds
cd ..
mv species_name ../GENOMES_done/

# second situation:
# lcl beginning, using pacid or protein_id
cat genome.longest.gff |
    tsv-filter --str-eq 3:CDS |
    tsv-select -f 1,9 |
    perl -nla -e '
        $F[1] =~ /ID=(.+?)\.CDS.+Source_ID=cds-(.+);$/;
        print "$F[0]_cds_$2\tspecies_name_$1";
    ' |
    tsv-uniq \
    > name.lst

cat genome.cds |
    perl -nle '
        print uc $_ if /^[AGCTN]/i;
        print ">$1" if /^>lcl\|(.+)_\d+\s+\[/;
    ' \
    > species_name.cds

faops replace -s species_name.cds name.lst species_name.cds.fa

mkdir ../../GENOMES/species_name
mv species_name.cds.fa name.lst ../../GENOMES/species_name
rm species_name.cds
cd ..
mv species_name ../GENOMES_done/

# third situation: 
# || to split gff
cat genome.longest.gff |
    tsv-filter --str-eq 3:mRNA |
    tsv-select -f 9 |
    perl -nle '
        print "$2\tspecies_name_$1" if /Name=(.+?);Source_ID=(.+);$/;
    ' \
    > name.lst

cat genome.cds |
    perl -nle '
    print uc $_ if /^[AGCTN]/i;
    print ">$1" if /^>.+\|\|(NNU.+?)\|.+/;
    ' \
    > species_name.cds

faops replace -s species_name.cds name.lst species_name.cds.fa

mkdir ../../GENOMES/species_name
mv species_name.cds.fa name.lst ../../GENOMES/species_name
rm species_name.cds
cd ..
mv species_name ../GENOMES_done/

# forth situation:
# change name directly when no multi-transcripts
cat genome.cds |
    perl -nle '
    print uc $_ if /^[AGCTN]/i;
    print ">species_name_$1" if /^>(.+?)$/;
    #print ">species_name_$1" if /^>(.+?)\s/;
    ' \
    > species_name.cds.fa
```

- Change the structure of directories

```bash
mkdir ~/data/symbio/CDS
cd ~/data/symbio/GENOMES_done

# double check
# whether species_dir has the right re-named files
for dir in $(ls)
do
    echo "==> $dir"
    ls ${dir}/*.cds.fa
    cat ${dir}/*.cds.fa | faops size stdin | head -n 1
done
# finally 5 dirs should be dealt manually: 
# boea_hygrometrica
# amborella_trichopoda
# isoetes_taiwanensis
# mimulus_guttatus
# bonia_amplexicaulis
# complete them manually

for dir in $(ls)
do
    if [ ! -f ${dir}/${dir}.cds.fa ]; then
        echo "${dir} has problem"
    else
        mv ${dir}/${dir}.cds.fa ../CDS
    fi
done

cd ~/data/symbio
rm -rf GENOMES
mv GENOMES_done GENOMES
```

- Download directly from URL (no records in database)
  - fagopyrum_esculentum
  - allium_sativum
  - elaeis_guineensis
  - passiflora_edulis
  - daemonorops_jenkinsiana
  - sphagnum_magellanicum
  - adiantum_capillus-veneris (no longest gff)
  - ceratopteris_richardii, marchantia_paleacea
  - carica_papaya
  - phoenix_dactylifera
  - taxus_chinensis
  - sphagnum_fallax

- Discard
  - punica_granatum (gff has problem)
  - picea_abies (ftp cannot be accessed)

